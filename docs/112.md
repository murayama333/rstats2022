# 推測統計

# 母集団と標本

<img src="img/138.png" width="800px">

* 母集団とは関心のあるデータ全体
* 標本とは母集団から取り出した一部のデータ
* 標本から得られる標本統計量によってに母集団を特徴づける母数を推定する

> 推測統計では標本（データの一部）から母集団（データ全体）を推測します。

---

## 母集団（population）

* 母集団とは関心のあるデータ全体
* 母集団に含まれるデータ数が有限のものを有限母集団と呼ぶ（例：学生の数、投票数など）
* 母集団に含まれるデータ数が無限のものを無限母集団と呼ぶ（例：サイコロの出る目、コイン投げで表が出る回数など）

> 母集団データすべてを調査するものを全数調査、母集団データの一部を調査するものを標本調査と呼びます。

### 母数

* 母集団（データ全体）を特徴づける値
* 母集団の持つ分布を母集団分布とよび、母集団の平均や分散は母平均や母分散と呼ぶ
* 推測統計では標本から得られる標本統計量を使って母数を推定する

> 推測統計において、通常、母数とは未知のものです。標本から得られる標本統計量を使って母数を推定します。

---

## 標本（sample）

* 標本とは母集団から取り出した一部のデータ
* 母集団からデータの一部を抽出することを標本抽出（sampling）という
* 標本抽出には取り出したデータを元に戻す復元抽出と、取り出したデータを元に戻さない非復元抽出の2つがある

> ランダムに標本を抽出することを無作為抽出（random sampling）と呼びます。

### 標本統計量

* 標本データから計算される値
* 標本データから計算される平均や分散を標本平均や標本分散と呼ぶ
* ある母数を推定するために用いられる標本統計量を推定量（その値を推定値）と呼ぶ

> 標本データから計算された標本統計量の分布を標本分布と呼びます。

### 標本の大きさ（サンプルサイズ）

* 一般的に標本は母集団から取り出した複数のデータの集合である
* 標本の中には、母集団から取り出した複数のデータが含まれている
* 標本に含まれるでデータの数を標本の大きさ（サンプルサイズ）と呼ぶ

> 「標本」という言葉から「1つのデータ」を想像しないように注意してください。

---

## 推測統計の分類

* 推測統計
  * 推定
  * 検定

> 推測統計は大きく分けると推定と検定の2つの手法に分かれます。推定は標本統計量を使って母数の値を予測するもので、一つの値で値を予測する**点推定**と、データの範囲で値を予測する**区間推定**に分かれます。検定は、標本統計量を使って2つの仮説（帰無仮説と対立仮説）のうちどちらを採択するかを決定します。

---

## Rプログラミング

### 標本抽出 - sample1.R

* `sample` 関数によって母集団データから標本を抽出できる
* `sample` 関数は第1引数に母集団データ、第2引数にサンプルサイズ（標本のデータ数）を指定する

```r
population <- 1:6
sample1 <- sample(population, 3)
sample1
```


#### 実行結果

```r
> population <- 1:6
> sample1 <- sample(population, 3)
> sample1
[1] 2 5 3
```

---

### 復元抽出 - sample2.R

* `sample` 関数は `replace` 引数に論理値（ `TRUE` , `FALSE` ）を指定することで、復元抽出、非復元抽出を指定できる
* `sample` 関数は `replace` 引数のデフォルト値は `FALSE` であるため、引数を省略した場合は非復元抽出となる

```r
sample2 <- sample(population, 5, replace = T)
sample2
```

> 引数 ``

#### 実行結果

```r
> sample2 <- sample(population, 5, replace = T)
> sample2
[1] 5 4 3 6 4
```

---

### 確率を伴う標本抽出 - sample3.R

* `sample` 関数は `prop` 引数によって確率分布を指定できる
* `prop` 引数には母集団データと等しい要素数を持つベクトルを指定する

```r
prob <- c(0.1, 0.1, 0.1, 0.1, 0.1, 0.5)
sample3 <- sample(population, 5, replace = T, prob = prob)
sample3
```

#### 実行結果

```r
> prob <- c(0.1, 0.1, 0.1, 0.1, 0.1, 0.5)
> sample3 <- sample(population, 5, replace = T, prob = prob)
> sample3
[1] 6 6 3 6 6
```

---

### 参考：擬似的な母集団データの作り方 - sample4.R

* `runif` 関数は一様分布に従って乱数を生成する
* `runif` 関数は`min`引数、 `max` 引数によって返却するデータの範囲を指定できる
* `ceiling` 関数は数値の切り上げを行う

```r
population <- ceiling(runif(10000, min = 0, max = 6))
table(population)
sample4 <- sample(population, 10, replace = T)
sample4
```

#### 実行結果

```r
> population <- ceiling(runif(10000, min = 0, max = 6))
> table(population)
population
   1    2    3    4    5    6 
1653 1710 1656 1653 1631 1697 
> sample4 <- sample(population, 10, replace = T)
> sample4
 [1] 6 3 5 5 4 2 4 1 6 6
```

---

## エクササイズ

1. 以下のデータを母集団とみなして、サンプルサイズ5の標本を作成してください。

```
171 173 169 173 161 171 167 167 177 164 178 168 167 166 170 166 169 169 168 162
```

2. 以下のURLから母集団データをダウンロードして、サンプルサイズ10の標本を作成してください。

```
https://gist.githubusercontent.com/murayama333/7433f62321fc684330068a5cf96cbc94/raw/4a6ed7d30a53b77540c8ee973520309169eb1aba/my_data.csv
```


