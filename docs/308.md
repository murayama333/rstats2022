# 離散型確率変数

* 離散型確率変数とは確率変数の取りうる値が離散値（非連続値）となるもの
* 離散型確率変数はとりうる値と、その値の出現する確率を関数（確率分布関数）で表現できる
* コイン投げの結果やサイコロの出目などは離散型確率変数として考えることができる

---

## 離散型確率変数の確率分布

* 離散型確率変数の確率は関数で表現できる
* このような関数を確率分布関数や、単純に確率分布と呼ぶ

<img src="img/290.png" width="200px">

> 連続型確率変数の場合は確率を関数で表すのではなく、確率密度を関数で表現します。

### 例：サイコロの出目を表す確率分布関数

<img src="img/289.png" width="400px">

```
P(X) = 1/6
```

あるいはXのとりうる範囲を具体的にして以下のように表現しても良い

```
P(X) = 1/6 : X ∈ {1, 2, 3, 4, 5, 6}
       0   : else
```

> A ∈ B とは要素Aは集合Bに属するという意味です。またここでは : を使って条件分けを記述しています。確率統計の書籍では : を使わずに { を使って条件分けを記述することが多いです。サイコロでは1から6までの整数しかありえないので、それ以外の数値の出現する確率は0と記述しています。


### 例：2つのサイコロの出目の和を表す確率分布関数

<img src="img/321.png" width="600px">

```
P(X) = 1/36 * (X - 1)  : X ∈ {2, 3, 4, 5, 6, 7}
       1/36 * (13 - X) : X ∈ {8, 9, 10, 11, 12}
       0               : else
```

---


## 離散型確率変数の期待値

* 離散型確率変数Xの期待値 E(X) は以下のようになる

<img src="img/291.png" width="200px">

> 離散型確率変数の期待値 E(X) は、確率変数の値と確率を掛け算したものの総和です。単純な数式ですので意味を理解しておきましょう。

### 例：サイコロの出目の期待値

<img src="img/289.png" width="400px">

```
E(X) = ΣxP(x) = Σ(X * 1/6)
     = (1 * 1/6) + (2 * 1/6) + (3 * 1/6) + (4 * 1/6) + (5 * 1/6) + (6 * 1/6) 
     = 3.5
```

### 例：2つのサイコロの出目の和の期待値

<img src="img/321.png" width="600px">

```
E(X) = (2 * 1/36) + (3 * 2/36) + (4 * 3/36) + (5 * 4/36) + (6 * 5/36) + (7 * 6/36) + 
       (8 * 5/36) + (9 * 4/36) + (10 * 3/36) + (11 * 2/36) + (12 * 1/36)
     = 7
```

---

## 離散型確率変数の分散

* 離散型確率変数Xの分散 V(X) は以下のようになる

<img src="img/292.png" width="240px">

> 確率変数Xの期待値 E[X] を μ で表現しています。確率変数の値と期待値の偏差の2乗値に確率を掛け算したものの総和です。この数式も難しくありませんが次の式で計算する方が簡単になることが多いです。

* あるいは分散 V(X) は以下のように期待値で表現することもできる

<img src="img/293.png" width="480px">

> 分散は「確率変数 X の2乗の期待値 - 確率変数 X の 期待値の2乗」`E(X^2) - E(X)^2` によって簡単に計算できます。この計算式を覚えておくと便利です。


### 例：サイコロの出目の分散

<img src="img/289.png" width="400px">

```
E(X) = 3.5
(E(X))^2 = 3.5 * 3.5 = 12.25

E(X^2) =  (1^2 * 1/6) + (2^2 * 1/6) + (3^2 * 1/6) + (4^2 * 1/6) + (5^2 * 1/6) + (6^2 * 1/6) 
     = 15.16667

V(X) = E(X^2) - (E(X))^2 = 15.16667 - 12.25 = 2.91667
```

### 例：2つのサイコロの出目の和の分散

<img src="img/321.png" width="600px">

```
E(X) = 7.0
(E(X))^2 = 7.0 * 7.0 = 49.0

E(X^2) = (2^2 * 1/36) + (3^2 * 2/36) + (4^2 * 3/36) + (5^2 * 4/36) + (6^2 * 5/36) + (7^2 * 6/36) + (8^2 * 5/36) + (9^2 * 4/36) + (10^2 * 3/36) + (11^2 * 2/36) + (12^2 * 1/36)
     = 54.83333

V(X) = E(X^2) - (E(X))^2 = 54.83333 - 49 = 5.83333
```

> 2つのサイコロの出目の和の分散 `5.83333` は、サイコロが1つの場合の分散（ `2.91667` ）と比べて2倍となっている点にも注目してください。**独立な確率変数の和の分散は各変数の分散の和**となります。

---


## 離散型確率変数の確率分布

* 離散型確率変数の代表的な確率分布は以下のとおり
    * 離散一様分布
    * ベルヌーイ分布
    * 二項分布
    * ポアソン分布
    * 幾何分布

> これらの確率分布の詳細については後述します。

---

## エクササイズ

### 設問1

1枚のコインを投げて表の出る回数を確率変数Xとします。

1. 確率分布関数 P(X) を求めてください。

#### ヒント

```
P(X) = ? : X = 0
       ? : X = 1
```

2. 確率変数Xの期待値 E[X] を求めてください。
3. 確率変数Xの分散 V[X] を求めてください。

---

### 設問2

2枚のコインを投げて表の出る回数を確率変数Xとします。

1. 確率分布関数 P(X) を求めてください。

#### ヒント

```
P(X) = ? : X = 0
       ? : X = 1
       ? : X = 2
```

2. 確率変数Xの期待値 E[X] を求めてください。
3. 確率変数Xの分散 V[X] を求めてください。

---

### 設問3

3枚のコインを投げて表の出る回数を確率変数Xとします。

1. 確率分布関数 P(X) を求めてください。

#### ヒント

```
P(X) = ? : X = 0
       ? : X = 1
       ? : X = 2
       ? : X = 3
```

2. 確率変数Xの期待値 E[X] を求めてください。
3. 確率変数Xの分散 V[X] を求めてください。

---

### 設問4

2つのサイコロを投げて出目の大きい方を確率変数Xでとします。

1. 確率分布関数 P(X) を求めてください。
2. 確率変数Xの期待値 E[X] を求めてください。
3. 確率変数Xの分散 V[X] を求めてください。

---

<!-- 


### 設問1

1枚のコインを投げて表の出る回数を確率変数Xとします。

1. 確率分布関数 P(X) を求めてください。

#### ヒント

```
P(X) = 0.5 : X = 0
       0.5 : X = 1
```

2. 確率変数Xの期待値 E[X] を求めてください。

E(X) = 0 * 0.5 + 1 * 0.5 = 0.5

3. 確率変数Xの期待値 V[X] を求めてください。

E(X^2) = 0^2 * 0.5 + 1^2 * 0.5 = 0.5
E(X)^2 = 0.5^2 = 0.25

V(X) = E(X^2) - E(X)^2 = 0.5 - 0.25 = 0.25

---

### 設問2

2枚のコインを投げて表の出る回数を確率変数Xとします。

1. 確率分布関数 P(X) を求めてください。

#### ヒント

```
P(X) = 1/4 : X = 0
       1/2 : X = 1
       1/4 : X = 2
```

2. 確率変数Xの期待値 E[X] を求めてください。

E(X) = 0 * 1/4 + 1 * 1/2 + 2 * 1/4 = 1


3. 確率変数Xの期待値 V[X] を求めてください。

E(X^2) = 0^2 * 1/4 + 1^2 * 1/2 + 2^2 * 1/4 = 1.5
E(X)^2 = 1^2 = 1

V(X) = E(X^2) - E(X)^2 = 1.5 - 1 = 0.5 

---

### 設問3

3枚のコインを投げて表の出る回数を確率変数Xとします。

ooo - 3
oox - 2
oxo - 2
xoo - 2
oxx - 1
xxo - 1
xox - 1
xxx - 0


1. 確率分布関数 P(X) を求めてください。

#### ヒント

```
P(X) = 1/8 : X = 0
       3/8 : X = 1
       3/8 : X = 2
       1/8 : X = 3
```

2. 確率変数Xの期待値 E[X] を求めてください。

E(X) = 0 * 1/8 + 1 * 3/8 + 2 * 3/8 + 3 * 1/8 = 1.5

3. 確率変数Xの期待値 V[X] を求めてください。

E(X^2) = 0^2 * 1/8 + 1^2 * 3/8 + 2^2 * 3/8 + 3^2 * 1/8 = 3
E(X)^2 = 1.5^2 = 2.25

V(X) = E(X^2) - E(X)^2 = 3 - 2.25 = 0.75

---

### 設問4

2つのサイコロを投げて出目の大きい方を確率変数Xでとします。

1. 確率分布関数 P(X) を求めてください。


P(X) = 1/36  : X = 1
       3/36  : X = 2
       5/36  : X = 3
       7/36  : X = 4
       9/36  : X = 5
       11/36 : X = 6

2. 確率変数Xの期待値 E[X] を求めてください。

E(X) = 1 * 1/36 + 2 * 3/36 + 3 * 5/36 + 4 * 7/36 + 5 * 9/36 + 6 * 11/36 = 4.472222

3. 確率変数Xの期待値 V[X] を求めてください。

E(X^2) = 1^2 * 1/36 + 2^2 * 3/36 + 3^2 * 5/36 + 4^2 * 7/36 + 5^2 * 9/36 + 6^2 * 11/36 = 21.97222
E(X)^2 = 4.472222^2 = 20.00077
V(X) = E(X^2) - E(X)^2 = 21.97222 - 20.00077 = 1.97145

-->