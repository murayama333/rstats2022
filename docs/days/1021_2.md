# 確率変数の性質

## 2つの確率変数

* 次の2つの確率変数がある
  * N(100, 10^2) にしたがう確率変数X
  * N(200, 20^2) にしたがう確率変数Y

```r
X <- rnorm(1, 100, 10)
X
Y <- rnorm(1, 200, 20)
Y
```

### 実行結果

```r
> X <- rnorm(1, 100, 10)
> X
[1] 100.4246
> Y <- rnorm(1, 200, 20)
> Y
[1] 199.0393
```

---

## 2つの確率変数の和の期待値

* 2つの確率変数XとYの和について考える

```r
X <- rnorm(1, 100, 10)
Y <- rnorm(1, 200, 20)
X + Y
```

### 実行結果

```r
> X <- rnorm(1, 100, 10)
> Y <- rnorm(1, 200, 20)
> X + Y
[1] 297.3473
```

> 2つの確率変数XとYの和も確率変数です。

* 2つの確率変数XとYの和の期待値について考える
* 10,000回繰り返し実行する

```r
total = numeric(10000)
for (i in 1:10000) {
  X <- rnorm(1, 100, 10)
  Y <- rnorm(1, 200, 20)
  total[i] <- X + Y
}
mean(total)
```

> `numeric(10000)` とすることで要素数が10000の整数ベクトルを用意しています。

### 実行結果

```r
> total = numeric(10000)
> for (i in 1:10000) {
+   X <- rnorm(1, 100, 10)
+   Y <- rnorm(1, 200, 20)
+   total[i] <- X + Y
+ }
> mean(total)
[1] 300.1271
```

> 2つの確率変数XとYの和の期待値は300に近い値になります。

* 2つの確率変数の和の期待値

$$
E[X + Y] = E[X] + E[Y] 
$$

---

## 2つの確率変数の和の分散

* 2つの確率変数XとYの和の分散について考える

* 10,000回繰り返し実行する

```r
total = numeric(10000)
for (i in 1:10000) {
  X <- rnorm(1, 100, 10)
  Y <- rnorm(1, 200, 20)
  total[i] <- X + Y
}
var(total)
```

### 実行結果

```r
> total = numeric(10000)
> for (i in 1:10000) {
+   X <- rnorm(1, 100, 10)
+   Y <- rnorm(1, 200, 20)
+   total[i] <- X + Y
+ }
> var(total)
[1] 499.3129
```

> 2つの確率変数XとYの和の分散は500に近い値になります。

* 2つの確率変数の和の分散（XとYが独立である場合）

$$
V[X + Y] = V[X] + V[Y] 
$$

* （参考）2つの確率変数の和の分散（XとYが独立でない場合）

$$
V[X + Y] = V[X] + V[Y] + 2Cov(X, Y)
$$

> Cov(X, Y) は2つの確率変数の共分散を意味します。

---

## 確率変数の期待値の性質

* 確率変数Xについて `aX + b` の期待値を考える

```r
a = 2
b = 10
total = numeric(10000)
for (i in 1:10000) {
  X <- rnorm(1, 100, 10)
  total[i] <- a * X + b
}
mean(total)
```

### 実行結果

```r
> a = 2
> b = 10
> total = numeric(10000)
> for (i in 1:10000) {
+   X <- rnorm(1, 100, 10)
+   total[i] <- a * X + b
+ }
> mean(total)
[1] 210.1242
```

> 確率変数Xの期待値を2倍して、10加算した値である210に近い値となります。

* 確率変数Xについて `aX + b` の期待値は以下のように計算できる

$$
E[aX + b] = a E[X] + b 
$$

---

## 確率変数の分散の性質

* 確率変数Xについて `aX + b` の分散を考える

```r
a = 2
b = 10
total = numeric(10000)
for (i in 1:10000) {
  X <- rnorm(1, 100, 10)
  total[i] <- a * X + b
}
var(total)
```

### 実行結果

```r
> a = 2
> b = 10
> total = numeric(10000)
> for (i in 1:10000) {
+   X <- rnorm(1, 100, 10)
+   total[i] <- a * X + b
+ }
> var(total)
[1] 400.5825
```

> 確率変数Xの分散 100 を2^2倍した値である400に近い値となります。

* 確率変数Xについて `aX + b` の分散は以下のように計算できる

$$
V[aX + b] =  a^2 V[X]
$$

---

## 確率変数の平均値の期待値と分散

* 複数の確率変数の平均値について、期待値と分散を考える

```r
X_means = numeric(10000)
for (i in 1:10000) {
  X <- rnorm(4, 100, 10)
  X_means[i] <- mean(X)
}
mean(X_means)
var(X_means)
```

### 実行結果

```r
> X_means = numeric(10000)
> for (i in 1:10000) {
+   X <- rnorm(4, 100, 10)
+   X_means[i] <- mean(X)
+ }
> mean(X_means)
[1] 100.0349
> var(X_means)
[1] 24.71143
```

> 確率変数の平均値の期待値は、その確率変数の期待値と一致します。一方で、確率変数の平均値の分散は、もとの確率変数の分散より小さくなっている（1/4になる）点に注意してください。

* 複数の確率変数の平均値について、期待値と分散を考えると次のようになる

$$
E[(X + X + X + X) / 4] = \frac{1}{4} ( E[X] + E[X] + E[X] + E[X]) = E[X]
$$


$$
V[(X + X + X + X) / 4] = (\frac{1}{4})^2 ( V[X] + V[X] + V[X] + V[X]) = \frac{1}{4}V[X]
$$

