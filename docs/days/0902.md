# 二項分布

## 例：コインを2回投げて表が1回出る確率

> ただし、コインが表となる確率は0.5とする

|1回目|2回目|
|:--:|:--:|
|o|o|
|o|x|
|x|o|
|x|x|

> 表を見ると、2回のコイン投げの結果は全部で4通りあり、そのうち1回が表をむくものは2通りあるのがわかります。コインを2回投げて表が1回になる確率は0.5（50%）ということがわかります。

---

## 二項分布

二項分布にしたがう確率変数X

$$
X \sim Bi(n, p)
$$

|パラメータ|意味|
|:--|:--|
|n|試行回数|
|p|1回あたりの成功確率|

> `n` 、 `p` は二項分布の形を決定するパラメータです。

### 例：コインを2回投げて表が1回になる確率

$$
X \sim Bi(n = 2, p = 0.5)
$$

> この場合、確率変数 `X` には 0, 1, 2 のいずれかの値が代入されます。その値を決定する確率分布は `Bi(2, 0.5)` という意味です。

---


## 二項分布の確率関数

$$
P(X) = {}_nC_{x}p^x(1-p)^{n-x}
$$

> 初見だとむずかしく見えますが、`n`, `p` は事前に与えられるパラメータです。`x` のみを変数と考えます。


### 例：コインを2回投げて表が1回になる確率

二項分布のパラメータは以下のとおり

$$
\begin{aligned}
&n = 2\\
&p = 0.5\\
\end{aligned}
$$

確率変数 X = 1 となる確率は以下のようになる

$$
\begin{aligned}
P(X = 1) &= {}_2C_10.5^10.5^{2-1}\\
&= 2 \times 0.5 \times 0.5 = 0.5
\end{aligned}
$$

> 2回の試行は独立しているので、1回の試行で表となる確率：0.5 x 1回の試行で裏となる確率：0.5により0.25となります。また1回が表となる組み合わせは2通りあるので、2 * 0.25 = 0.5 と考えます。

### 例：コインを2回投げて表が2回になる確率

$$
\begin{aligned}
P(X) &= {}_nC_{x}p^x(1-p)^{n-x}\\
&= {}_2C_20.5^{2}0.5^{2-2}\\
&= 1 \times 0.25 \times 1 = 0.25
\end{aligned}
$$

---

### エクササイズ

1. 表となる確率が0.8のイカサマのコインがある。
    1. このコインを2回投げたとき、表が0回となる確率はいくらか
    2. このコインを2回投げたとき、表が1回となる確率はいくらか
    3. このコインを2回投げたとき、表が2回となる確率はいくらか

2. サイコロを投げて1が出る回数を考える。
    1. サイコロを2回投げたとき、1が0回でる確率はいくらか
    2. サイコロを2回投げたとき、1が1回でる確率はいくらか
    3. サイコロを2回投げたとき、1が2回でる確率はいくらか

3. ジョーカーをのぞいたトランプが52枚ある。このトランプの山からカードを3枚ひく。ただし、1枚ひくごとに、ひいたカードは山に戻してシャッフルするものとする。
    1. ハートが0枚である確率はいくらか
    1. ハートが1枚である確率はいくらか
    1. ハートが2枚である確率はいくらか
    1. ハートが3枚である確率はいくらか
    1. 3枚でとも絵札（11-13）である確率はいくらか
    
---

## 参考：二項定理

$$
(a + b)^n = \sum_{x=0}^{n}{}_nC_xa^xb^{n-x}
$$

以下のように指数を入れ替えてもよい

$$
(a + b)^n = \sum_{x=0}^{n}{}_nC_xa^{n-x}b^{x}
$$


### 例： n = 2 のとき

$$
\begin{aligned}
(a + b)^2 &= \sum_{x=0}^{2}{}_2C_xa^xb^{2-x}\\
&= {}_2C_0a^0b^{2-0} + {}_2C_1a^1b^{2-1} + {}_2C_2a^2b^{2-2}\\
&= b^{2} + 2ab + a^2
\end{aligned}
$$

### 例： n = 3 のとき

$$
\begin{aligned}
(a + b)^3 &= \sum_{x=0}^{3}{}_3C_xa^xb^{3-x}\\
&= {}_3C_0a^0b^{3-0} + {}_3C_1a^1b^{3-1} + {}_3C_2a^2b^{3-2}  + {}_3C_3a^3b^{3-3}\\
&= b^{3} + 3ab^2 + 3a^2b + a^3
\end{aligned}
$$

---