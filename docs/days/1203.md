# 区間推定

* 母集団は正規分布である

$$
X \sim N(\mu, \sigma^2)
$$

---

## 家賃の区間推定

* 一人暮らしをしている学生について、毎月の家賃を調査しています。ランダムに標本を抽出したところ以下のようになりました。単位は千円です。

```
50, 48, 72, 52, 55, 60, 40, 49
```

1. 母分散が100であると仮定して母平均を区間推定してください。ただし信頼係数95%とします。
2. 母分散が未知の場合も同様に、母平均を信頼係数95%で区間推定してください。
3. 母分散について信頼係数95%で区間推定してください。
---

### 母分散が既知の場合

* 解法
  * （標準）正規分布を使って区間推定する
* 計算の流れ
  * 標本平均を求める
  * 標本平均の従う確率分布について考える
  * 標本平均を標準化する
  * 標準化した標本平均の従う確率分布について考える
  * 信頼係数を使って信頼区間を求める


#### 標本平均を求める

$$
\bar{x} = \frac{1}{n}\sum_{i=1}^n x_i
$$

#### 標本平均の従う確率分布について考える

$$
\bar{x} \sim N(\mu, \frac{\sigma^2}{n})
$$


#### 標本平均を標準化する

$$
z = \frac{\bar{x} - \mu}{\sigma/\sqrt{n}}
$$

> 母分散は100であるので、σに10を代入できる

#### 標準化した標本平均の従う確率分布について考える

$$
z \sim N(0, 1)
$$

#### 信頼係数を使って信頼区間を求める

$$
-1.96 \le z \le 1.96
$$

$$
-1.96 \le \frac{\bar{x} - \mu}{\sigma/\sqrt{n}} \le 1.96
$$

$$
\bar{x} -1.96 \frac{\sigma}{\sqrt{n}}  \le \mu \le \bar{x} + 1.96 \frac{\sigma}{\sqrt{n}}
$$

#### サンプルコード

#### サンプルコード

```r
rents <- c(50, 48, 72, 52, 55, 60, 40, 49)
# 母分散が100の場合
sigma2 <- 100
sigma <- sqrt(sigma2)
# 区間推定
rents_mean <- mean(rents)
rents_n <- length(rents)
min <- rents_mean - 1.96 * sigma / sqrt(rents_n)
max <- rents_mean + 1.96 * sigma / sqrt(rents_n)
paste(min, "-", max)
```

#### 実行結果

```r
> rents <- c(50, 48, 72, 52, 55, 60, 40, 49)
> # 母分散が100の場合
> sigma2 <- 100
> sigma <- sqrt(sigma2)
> # 区間推定
> rents_mean <- mean(rents)
> rents_n <- length(rents)
> min <- rents_mean - 1.96 * sigma / sqrt(rents_n)
> max <- rents_mean + 1.96 * sigma / sqrt(rents_n)
> paste(min, "-", max)
[1] "46.3203535443718 - 60.1796464556282"
```