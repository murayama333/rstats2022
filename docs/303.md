# 確率

* 確率とは事象の起こりやすさを定量的に表現したもの
* ここでは確率について記号 `P` を使って記述する方法を学習する
* 実際には確率の定義には様々なアプローチがある
  * 先験的確率
  * 経験的確率
  * 主観的確率
  * 確率の公理
---

## 確率の記述方法

サイコロを振って1が出る事象を事象Xとする。事象Xの確率は以下のように表現できる。

```
P(X) = 1/6
```

あるいは単純に以下のように表現することもできる。

```
P(サイコロを振って1が出る) = 1/6
```

> 確率はProbabilityの頭文字 P で表現します。また()の中には事象を記述します。


### 具体例

* サイコロを1回振って奇数がでる事象Xの確率

```
X = {1, 3, 5}
P(X) = 3 / 6
```

* サイコロを1回振って3以下の数値がでる事象Yの確率

```
Y = {1, 2, 3}
P(Y) = 3 / 6
```

* サイコロを1回振って奇数がでる事象Xかつ、3以下の数値がでる事象Yの確率

```
X = {1, 3, 5}
Y = {1, 2, 3}
P(X∩Y) = 2 / 6
```

---

## 確率の定義1. 先験的確率

* 実際に経験しなくても計算によって算出できる確率
* コイン投げやサイコロ、トランプのような問題を取り扱う
* ラプラスの定義や古典的確率とも呼ばれる

```
P(A) = R / N
```

* N：全事象の根元事象の数（**根元事象は同様に確からしい**とする）
* R：事象Aの根元事象の数

### 具体例

サイコロを振って偶数が出る事象を事象Yとする。

```
N: 6 ※1, 2, 3, 4, 5, 6 の6通り
R: 3 ※2, 4, 6 の3とおり
P(Y) = 3/6
```

> ラプラスの定義は、根元事象が"同様に確からしい"ことを前提としています。この"同様に確からしい"とは、例えば、コイン投げの裏表が出る確率がどちらも1/2になるようなケースや、サイコロの出る目はどれも1/6になるようなケースを指します。

---

## 確率の定義2. 経験的確率

* イカサマのサイコロがある場合、1の目の出る確率は実際に振ってみないとわからない
* このようなケースにおいては繰り返し何度もサイコロを振ることで、1の目の出る確率を求めることができる
* たとえば100回サイコロを振って、1の目が50回出た場合、1の目の出る確率は 50/100 と推測できる

> **"同様に確からしい"** という前提を満たさない場合は頻度による確率の定義を考えます。

### 具体例

* 以下のようなイカサマのサイコロを準備した場合

|1|2|3|4|5|6|
|:--|:--|:--|:--|:--|:--|
|0.5|0.1|0.1|0.1|0.1|0.1|

> このような確率の定義は、**頻度による確率の定義** と呼ぶこともあります。実際には上記の確率分布を知らなくても、試行を何度も繰り返すことで相対頻度（1が出た回数/試行回数）から確率を求めることができます。

#### Rのサンプルコード

```r
dice_prob <- c(0.5, 0.1, 0.1, 0.1, 0.1, 0.1)
for (i in 1:3) {
  dice <- sample(1:6, size = 100, prob = dice_prob, replace = T)
  print(table(dice))
}
```

#### 実行結果

```r
> dice_prob <- c(0.5, 0.1, 0.1, 0.1, 0.1, 0.1)
> for (i in 1:3) {
+   dice <- sample(1:6, size = 100, prob = dice_prob, replace = T)
+   print(table(dice))
+ }
dice
 1  2  3  4  5  6 
60  8 15  3  7  7 
dice
 1  2  3  4  5  6 
51  9 14 10  7  9 
dice
 1  2  3  4  5  6 
55 11 11  6 11  6 
```

> 実行結果は誤差を含みます。試行回数を増やせば1の出る確率は理論値の0.5に近づきます。

---

## 確率の定義3. 主観的確率

* 先験的確率や経験的確率は誰が計算しても同じ結果になる（客観的確率）
* 上記のアプローチが取れない場合においては、分析者が対象に対して主観的に確率を与えて分析を行う手法がある
* このような主観的確率は、ベイズの定理という手法を用いるためベイズ統計学とも呼ばれる

> ベイズの定理については後述します。

---

## 確率の定義4. 確率の公理

* すべての事象Aに対して 0 <= P(A) <= 1 
* P(Ω) = 1
* 排反な事象A1,A2,A3...に対して P(A1 ∪ A2 ∪ A3...) = P(A1) + P(A2) + P(A3) ...

> 確率の公理はコルモゴロフの公理とも呼ばれます。先験的確率・経験的確率・主観的確率のいずれの手法を用いるとしても確率の公理に従います。

---

## エクササイズ

### 設問1

 「2枚のコイン投げ」という試行において表をT、裏をFとしたとき、標本空間を以下のように定義しました。

```
Ω = {(T, T), (T, F), (F, T), (F, F)}
```

このとき、少なくとも1回は表が出る事象Aを以下のように定義します。

```
A = {(T, T), (T, F), (F, T)}
```

この事象Aの確率は以下のように記述します。

```
P(A) = 3 / 4
```

以下の設問に答えてください。

* 少なくとも1回は裏が出る事象Bの確率を求めてください。
* 表が2回でる事象Cの確率を求めてください。
* 事象Aの補事象を事象Dとします。事象Dの確率を求めてください。

---

### 設問2

「2つのサイコロを投げる」という試行の標本空間Ωを以下のように定義しました。

```
(1, 1) (1, 2) (1, 3) (1, 4) (1, 5) (1, 6)
(2, 1) (2, 2) (2, 3) (2, 4) (2, 5) (2, 6)
(3, 1) (3, 2) (3, 3) (3, 4) (3, 5) (3, 6)
(4, 1) (4, 2) (4, 3) (4, 4) (4, 5) (4, 6)
(5, 1) (5, 2) (5, 3) (5, 4) (5, 5) (5, 6)
(6, 1) (6, 2) (6, 3) (6, 4) (6, 5) (6, 6)
```

このとき、少なくとも1回は1が出る事象Aを以下のように定義します。

```
A = {(1, 1) (1, 2) (1, 3) (1, 4) (1, 5) (1, 6), (2, 1), (3, 1), (4, 1), (5, 1), (6, 1)}
```

また事象Aの確率は以下のように記述します。

```
P(A) = 11/36
```

以下の設問に答えてください。

* 2つのサイコロを投げた結果の合計が7になる事象Bの確率を求めてください。
* 事象Aと事象Bの積集合（A∩B）の確率を求めてください。
* 事象Aと事象Bの和集合（A∪B）の確率を求めてください。

---

### 設問3

あるサイコロを100回振った結果、以下のようになった。

|目|出現回数|
|:--:|:--:|
|1|24|
|2|16|
|3|14|
|4|18|
|5|16|
|6|12|

以下の設問に答えてください。

* 先験的確率によるサイコロの1の目が出る確率を求めてください。
* 経験的確率によるサイコロの1の目が出る確率を求めてください。

<!-- 
設問1
A = {(T, T), (T, F), (F, T)}
P(A) = 3/4
B = {(F, F), (T, F), (F, T)}
P(B) = 3/4
C = {(T, T)}
P(C) = 1/4
D = {(F, F)}
P(D) = 1/4


設問2
2つのサイコロを投げた結果の合計が7になる事象Bの確率を求めてください。

B = {(1, 6), (2, 5), (3, 4), (4, 3), (5, 2), (6, 1)}
P(B) = 6/36 = 1/6

事象Aと事象Bの積集合（A∩B）の確率を求めてください。

A = {(1, 1) (1, 2) (1, 3) (1, 4) (1, 5) (1, 6), (2, 1), (3, 1), (4, 1), (5, 1), (6, 1)}
P(A) = 11/36

B = {(1, 6), (2, 5), (3, 4), (4, 3), (5, 2), (6, 1)}
P(B) = 6/36 = 1/6


A∩B = {(1, 6), (6, 1)}
P(A∩B) = 2/36 = 1/18

事象Aと事象Bの和集合（A∪B）の確率を求めてください。


A = {(1, 1) (1, 2) (1, 3) (1, 4) (1, 5) (1, 6), (2, 1), (3, 1), (4, 1), (5, 1), (6, 1)}
P(A) = 11/36

B = {(1, 6), (2, 5), (3, 4), (4, 3), (5, 2), (6, 1)}
P(B) = 6/36 = 1/6

A∪B = {
    (1, 1) (1, 2) (1, 3) (1, 4) (1, 5) (1, 6), (2, 1), (3, 1), (4, 1), (5, 1), (6, 1), (2, 5), (3, 4), (4, 3), (5, 2)}
P(A∪B) = (11 + 6 - 2)/36 = 15/36

設問3
先験的確率によるサイコロの1の目が出る確率を求めてください。
1/6
経験的確率によるサイコロの1の目が出る確率を求めてください。
24/100 = 1/5
-->